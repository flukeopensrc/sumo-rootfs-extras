{
    "A14_DORM": {
        "description": "Set A14 to dormant.",
        "steps": [
            {
                "description": "Set TC RJ_MSR* hi",
                "operation": "write",
                "register": "P14P2",
                "value": "0x40"
            },
            {
                "description": "Set all other TC control bits hi",
                "operation": "write",
                "register": "P14P3",
                "value": "0xfc"
            },
            {
                "description": "Set all relays to dorm, part 1",
                "operation": "write",
                "register": "A14RLY1",
                "value": "0x100"
            },
            {
                "description": "Set all relays to dorm, part 2",
                "operation": "write",
                "register": "A14RLY2",
                "value": "0x000"
            },
            {
                "description": "Terminal rings for DCV, standby light on",
                "operation": "write",
                "register": "A14LED",
                "value": "0x0052"
            }
        ]
    },
    "A14_EXT_GUARD": {
        "description": "Set external guard",
        "steps": [
            {
                "description": "Set external guard relay",
                "operation": "modify",
                "register": "A14RLY2",
                "mask": "0x002",
                "value": "0x000"
            },
            {
                "description": "Update LED",
                "operation": "exec",
                "sequence": "A14_LED_EXT_GUARD"
            }
        ]
    },
    "A14_INT_GUARD": {
        "description": "Set internal guard",
        "steps": [
            {
                "description": "Reset external guard relay",
                "operation": "modify",
                "register": "A14RLY2",
                "mask": "0x002",
                "value": "0x002"
            },
            {
                "description": "Update LED",
                "operation": "exec",
                "sequence": "A14_LED_INT_GUARD"
            }
        ]
    },
    "A14_EXT_SENSE": {
        "description": "Only for V,120V and Z",
        "steps": [
            {
                "description": "",
                "operation": "modify",
                "register": "A14RLY1",
                "mask": "0x06c",
                "value": "0x048"
            },
            {
                "description": "Update LED",
                "operation": "exec",
                "sequence": "A14_LED_EXT_SENSE"
            }
        ]
    },
    "A14_INT_SENSE": {
        "description": "Only for V,120V and Z",
        "steps": [
            {
                "description": "",
                "operation": "modify",
                "register": "A14RLY1",
                "mask": "0x06c",
                "value": "0x024"
            },
            {
                "description": "Update LED",
                "operation": "exec",
                "sequence": "A14_LED_INT_SENSE"
            }
        ]
    },
    "A14_LOWS_TIED": {
        "description": "For dual output functions",
        "steps": [
            {
                "description": "",
                "operation": "modify",
                "register": "A14RLY2",
                "mask": "0x02c",
                "value": "0x020"
            }
        ]
    },
    "A14_LOWS_OPEN": {
        "description": "For dual output functions",
        "steps": [
            {
                "description": "",
                "operation": "modify",
                "register": "A14RLY2",
                "mask": "0x020",
                "value": "0x000"
            }
        ]
    },
    "A14_HII_STBY": {
        "description": "Used for single output ranges (>3A AC/DC)",
        "steps": [
            {
                "description": "This should already be set like this, but just in case",
                "operation": "write",
                "register": "A14RLY1",
                "value": "0x100"
            },
            {
                "description": "connect internal short, leaving terminals as they were",
                "operation": "modify",
                "register": "A14RLY2",
                "mask": "0x100",
                "value": "0x100"
            },
            {
                "description": "disconnect terminals",
                "operation": "write",
                "register": "A14RLY2",
                "value": "0x100"
            },
            {
                "description": "Set up terminal rings",
                "operation": "modify",
                "register": "A14LED",
                "mask": "0xFFF4",
                "value": "0x0902"
            }
        ]
    },
    "A14_HII_OPER": {
        "description": "Used for single output ranges (>3A AC/DC)",
        "steps": [
            {
                "description": "Turn operate LED on, standby off",
                "operation": "exec",
                "sequence": "A14_LED_OPER"
            },
            {
                "description": "Connect terminals, leaving internal short in place",
                "operation": "write",
                "register": "A14RLY2",
                "value": "0x1A0"
            },
            {
                "description": "Delay added per Jake's request",
                "operation": "delay",
                "value": "0x100"
            },
            {
                "description": "Disconnect internal short",
                "operation": "write",
                "register": "A14RLY2",
                "value": "0x0A0"
            }
        ]
    },
    "A14_HII_DUAL_STBY": {
        "description": "Used for dual output ranges (>3A AC/DC)",
        "steps": [
            {
                "description": "Disconnect low current high terminal just in case.",
                "operation": "modify",
                "register": "A14RLY1",
                "mask": "0x080",
                "value": "0x000"
            },
            {
                "description": "connect internal short, leaving terminals as they were",
                "operation": "modify",
                "register": "A14RLY2",
                "mask": "0x100",
                "value": "0x100"
            },
            {
                "description": "disconnect terminals",
                "operation": "modify",
                "register": "A14RLY2",
                "mask": "0x1E0",
                "value": "0x100"
            },
            {
                "description": "Set up current terminal rings",
                "operation": "modify",
                "register": "A14LED",
                "mask": "0x0E03",
                "value": "0x0A02"
            }
        ]
    },
    "A14_HII_DUAL_OPER": {
        "description": "Used for dual output ranges (>3A AC/DC)",
        "steps": [
            {
                "description": "Turn operate LED on, standby off",
                "operation": "exec",
                "sequence": "A14_LED_OPER"
            },
            {
                "description": "Connect terminals, leaving internal short in place",
                "operation": "modify",
                "register": "A14RLY2",
                "mask": "0x1E0",
                "value": "0x1C0"
            },
            {
                "description": "Disconnect internal short",
                "operation": "modify",
                "register": "A14RLY2",
                "mask": "0x1E0",
                "value": "0x0C0"
            }
        ]
    },
    "A14_HIV_STBY": {
        "description": "Used for single output hi voltage (1kV AC/DC, 330VAC)",
        "steps": [
            {
                "description": "standby relays",
                "operation": "write",
                "register": "A14RLY1",
                "value": "0x100"
            },
            {
                "description": "standby relays",
                "operation": "write",
                "register": "A14RLY2",
                "value": "0x000"
            },
            {
                "description": "Set up terminal rings",
                "operation": "modify",
                "register": "A14LED",
                "mask": "0xFFF4",
                "value": "0x0052"
            }
        ]
    },
    "A14_HIV_OPER": {
        "description": "Used for single output hi voltage (1kV AC/DC, 330VAC)",
        "steps": [
            {
                "description": "Turn operate LED on, standby off",
                "operation": "exec",
                "sequence": "A14_LED_OPER"
            },
            {
                "description": "A14RLY setting was 0x00031",
                "operation": "write",
                "register": "A14RLY1",
                "value": "0x131"
            }
        ]
    },
    "A14_HIV_DUAL_STBY": {
        "description": "Used for dual output ranges (1kV AC/DC, 330VAC)",
        "steps": [
            {
                "description": "standby relays",
                "operation": "modify",
                "register": "A14RLY1",
                "mask": "0x037",
                "value": "0x000"
            },
            {
                "description": "make sure internal guard relay is set",
                "operation": "modify",
                "register": "A14RLY2",
                "mask": "0x002",
                "value": "0x000"
            },
            {
                "description": "Set up current terminal rings",
                "operation": "modify",
                "register": "A14LED",
                "mask": "0x0053",
                "value": "0x0052"
            }
        ]
    },
    "A14_HIV_DUAL_OPER": {
        "description": "Used for dual output ranges (1kV AC/DC, 330VAC)",
        "steps": [
            {
                "description": "Turn operate LED on, standby off",
                "operation": "exec",
                "sequence": "A14_LED_OPER"
            },
            {
                "description": "",
                "operation": "modify",
                "register": "A14RLY1",
                "mask": "0x037",
                "value": "0x031"
            }
        ]
    },
    "A14_LOI_STBY": {
        "description": "Used for single output ranges (<3A AC/DC)",
        "steps": [
            {
                "description": "standby relays",
                "operation": "write",
                "register": "A14RLY1",
                "value": "0x100"
            },
            {
                "description": "standby relays",
                "operation": "write",
                "register": "A14RLY2",
                "value": "0x000"
            },
            {
                "description": "Set up terminal rings",
                "operation": "modify",
                "register": "A14LED",
                "mask": "0xFFF4",
                "value": "0x0502"
            }
        ]
    },
    "A14_LOI_OPER": {
        "description": "Used for single output ranges (<3A AC/DC)",
        "steps": [
            {
                "description": "Turn operate LED on, standby off",
                "operation": "exec",
                "sequence": "A14_LED_OPER"
            },
            {
                "description": "A14RLY setting was 0x04080",
                "operation": "write",
                "register": "A14RLY1",
                "value": "0x180"
            },
            {
                "description": "",
                "operation": "write",
                "register": "A14RLY2",
                "value": "0x020"
            }
        ]
    },
    "A14_LOI_DUAL_STBY": {
        "description": "Used for dual output ranges (<3A AC/DC)",
        "steps": [
            {
                "description": "Disconnect high terminal",
                "operation": "modify",
                "register": "A14RLY1",
                "mask": "0x080",
                "value": "0x000"
            },
            {
                "description": "Disconnect (dual output) low terminal",
                "operation": "modify",
                "register": "A14RLY2",
                "mask": "0x1E0",
                "value": "0x000"
            },
            {
                "description": "Set up current terminal rings",
                "operation": "modify",
                "register": "A14LED",
                "mask": "0x0E03",
                "value": "0x0602"
            }
        ]
    },
    "A14_LOI_DUAL_OPER": {
        "description": "Used for dual output ranges (<3A AC/DC)",
        "steps": [
            {
                "description": "Turn operate LED on, standby off",
                "operation": "exec",
                "sequence": "A14_LED_OPER"
            },
            {
                "description": "Connect (dual output) low terminal",
                "operation": "modify",
                "register": "A14RLY2",
                "mask": "0x0E0",
                "value": "0x040"
            },
            {
                "description": "Connect high terminal",
                "operation": "modify",
                "register": "A14RLY1",
                "mask": "0x080",
                "value": "0x080"
            }
        ]
    },
    "A14_LOV_STBY": {
        "description": "Low voltage standby relays and LEDS",
        "steps": [
            {
                "description": "standby relays",
                "operation": "write",
                "register": "A14RLY1",
                "value": "0x100"
            },
            {
                "description": "standby relays",
                "operation": "write",
                "register": "A14RLY2",
                "value": "0x000"
            },
            {
                "description": "Set up terminal rings",
                "operation": "modify",
                "register": "A14LED",
                "mask": "0xFFF4",
                "value": "0x0052"
            }
        ]
    },
    "A14_LOV_OPER": {
        "description": "Used for single output ranges (1V,10V, 100V AC/DC ranges) internal sense",
        "steps": [
            {
                "description": "Turn operate LED on, standby off",
                "operation": "exec",
                "sequence": "A14_LED_OPER"
            },
            {
                "description": "A14RLY setting was 0x00036",
                "operation": "write",
                "register": "A14RLY1",
                "value": "0x136"
            }
        ]
    },
    "A14_LOV_DUAL_STBY": {
        "description": "Used for dual output ranges < 330V",
        "steps": [
            {
                "description": "standby relays",
                "operation": "modify",
                "register": "A14RLY1",
                "mask": "0x037",
                "value": "0x000"
            },
            {
                "description": "make sure internal guard relay is set",
                "operation": "modify",
                "register": "A14RLY2",
                "mask": "0x002",
                "value": "0x000"
            },
            {
                "description": "Set up current terminal rings",
                "operation": "modify",
                "register": "A14LED",
                "mask": "0x0053",
                "value": "0x0052"
            }
        ]
    },
    "A14_LOV_DUAL_OPER": {
        "description": "Used for dual output ranges < 330V",
        "steps": [
            {
                "description": "Turn operate LED on, standby off",
                "operation": "exec",
                "sequence": "A14_LED_OPER"
            },
            {
                "description": "",
                "operation": "modify",
                "register": "A14RLY1",
                "mask": "0x037",
                "value": "0x036"
            }
        ]
    },
    "A14_MV_STBY": {
        "description": "Used for single output divided ranges (100mVDC, 10mVAC, 100mVAC)",
        "steps": [
            {
                "description": "standby relays",
                "operation": "write",
                "register": "A14RLY1",
                "value": "0x100"
            },
            {
                "description": "standby relays",
                "operation": "write",
                "register": "A14RLY2",
                "value": "0x000"
            },
            {
                "description": "Set up terminal rings",
                "operation": "modify",
                "register": "A14LED",
                "mask": "0xFFF4",
                "value": "0x0052"
            }
        ]
    },
    "A14_MV_OPER": {
        "description": "Used for single output divided ranges (100mVDC, 10mVAC, 100mVAC)",
        "steps": [
            {
                "description": "Turn operate LED on, standby off",
                "operation": "exec",
                "sequence": "A14_LED_OPER"
            },
            {
                "description": "A14RLY setting was 0x00012",
                "operation": "write",
                "register": "A14RLY1",
                "value": "0x112"
            }
        ]
    },
    "A14_MV_DUAL_STBY": {
        "description": "Used for dual output divided ranges (100mVDC, 10mVAC, 100mVAC)",
        "steps": [
            {
                "description": "standby relays",
                "operation": "modify",
                "register": "A14RLY1",
                "mask": "0x037",
                "value": "0x000"
            },
            {
                "description": "standby relays",
                "operation": "modify",
                "register": "A14RLY2",
                "mask": "0x002",
                "value": "0x000"
            },
            {
                "description": "Set up current terminal rings",
                "operation": "modify",
                "register": "A14LED",
                "mask": "0x0053",
                "value": "0x0052"
            }
        ]
    },
    "A14_MV_DUAL_OPER": {
        "description": "Used for dual output divided ranges (100mVDC, 10mVAC, 100mVAC)",
        "steps": [
            {
                "description": "Turn operate LED on, standby off",
                "operation": "exec",
                "sequence": "A14_LED_OPER"
            },
            {
                "description": "",
                "operation": "modify",
                "register": "A14RLY1",
                "mask": "0x037",
                "value": "0x012"
            }
        ]
    },
    "A14_TC_STBY": {
        "description": "Thermocouple source, standby",
        "steps": [
            {
                "description": "standby relays (TODO: use A10RLY instead?)",
                "operation": "write",
                "register": "A10RLY1",
                "value": "0x100"
            },
            {
                "description": "standby relays",
                "operation": "write",
                "register": "A14RLY2",
                "value": "0x000"
            },
            {
                "description": "Set all hi (TODO: Use A10SW instead?)",
                "operation": "write",
                "register": "P14P3",
                "value": "0xfc"

            },
            {
                "description": "Set up terminal rings",
                "operation": "modify",
                "register": "A14LED",
                "mask": "0xFFF4",
                "value": "0x4002"
            }
        ]
    },
    "A14_TC_OPER": {
        "description": "Thermocouple measure or source in operate",
        "steps": [
            {
                "description": "Turn operate LED on, standby off",
                "operation": "exec",
                "sequence": "A14_LED_OPER"
            },
            {
                "description": "Enable TC_SRC* (TODO: Use A10SW instead?)",
                "operation": "write",
                "register": "P14P3",
                "value": "0xf7"
            },
            {
                "description": "Activate TC relay (TODO: use A10RLY instead?)",
                "operation": "write",
                "register": "A14RLY1",
                "value": "0x000"
            }
        ]
    },
    "A14_TC_MEAS": {
        "description": "Thermocouple measure or source in operate",
        "steps": [
            {
                "description": "Turn operate LED on, standby off (TODO: presumably, measuring is in OPERATE",
                "operation": "exec",
                "sequence": "A14_LED_OPER"
            },
            {
                "description": "Enable TC_MSR* (TODO: Use A10SW instead?)",
                "operation": "write",
                "register": "P14P3",
                "value": "0xbf"
            },
            {
                "description": "Activate TC relay (TODO: use A10RLY instead?)",
                "operation": "write",
                "register": "A14RLY1",
                "value": "0x000"
            }
        ]
    },
    "A14_TC_EXIT": {
        "description": "Leave measure thermocouple function",
        "steps": [
            {
                "description": "standby relays (TODO: use A10RLY instead?)",
                "operation": "write",
                "register": "A10RLY1",
                "value": "0x100"
            },
            {
                "description": "standby relays",
                "operation": "write",
                "register": "A14RLY2",
                "value": "0x000"
            },
            {
                "description": "Set all hi (TODO: Use A10SW instead?)",
                "operation": "write",
                "register": "P14P3",
                "value": "0xfc"

            },
            {
                "description": "Turn off terminal rings (except standby)",
                "operation": "modify",
                "register": "A14LED",
                "mask": "0xFFF4",
                "value": "0x0002"
            }
        ]
    },
    "A14_Z_OPER": {
        "description": "Go to impedance output, operate (sense relays and LED rings are set separately)",
        "steps": [
            {
                "description": "Turn operate LED on, standby off",
                "operation": "exec",
                "sequence": "A14_LED_OPER"
            },
            {
                "description": "",
                "operation": "write",
                "register": "A14RLY2",
                "value": "0x004"
            },
            {
                "description": "A14RLY1 should be #h136 for internal sense, #h15a for external sense",
                "operation": "modify",
                "register": "A14RLY1",
                "mask": "0x193",
                "value": "0x112"
            }
        ]
    },
    "A14_Z_STBY": {
        "description": "Set up terminals for impedance output, internal or external sense, standby",
        "steps": [
            {
                "description": "",
                "operation": "write",
                "register": "A14RLY1",
                "value": "0x100"
            },
            {
                "description": "",
                "operation": "write",
                "register": "A14RLY2",
                "value": "0x004"
            },
            {
                "description": "Set up terminal rings",
                "operation": "modify",
                "register": "A14LED",
                "mask": "0xFFF4",
                "value": "0x0052"
            }
        ]
    },
    "A14_LED_OPER": {
        "description": "Turn operate light on and standby light off",
        "steps": [
            {
                "description": "",
                "operation": "modify",
                "register": "A14LED",
                "mask": "0x0003",
                "value": "0x0001"
            }
        ]
    },
    "A14_LED_STBY": {
        "description": "Turn operate LED off and standby light on",
        "steps": [
            {
                "description": "",
                "operation": "modify",
                "register": "A14LED",
                "mask": "0x0003",
                "value": "0x0002"
            }
        ]
    },
    "A14_LED_EXT_GUARD": {
        "description": "Dave guess",
        "steps": [
            {
                "description": "Illuminate guard terminal",
                "operation": "modify",
                "register": "A14LED",
                "mask": "0x0008",
                "value": "0x0008"
            }
        ]
    },
    "A14_LED_INT_GUARD": {
        "description": "Dave guess",
        "steps": [
            {
                "description": "Extinguish guard terminal",
                "operation": "modify",
                "register": "A14LED",
                "mask": "0x0008",
                "value": "0x0000"
            }
        ]
    },
    "A14_LED_EXT_SENSE": {
        "description": "Only for V,120V and Z",
        "steps": [
            {
                "description": "Illuminate out and sense terminals",
                "operation": "modify",
                "register": "A14LED",
                "mask": "0x00F0",
                "value": "0x00F0"
            }
        ]
    },
    "A14_LED_INT_SENSE": {
        "description": "Only for V,120V and Z",
        "steps": [
            {
                "description": "Illuminate out terminals only",
                "operation": "modify",
                "register": "A14LED",
                "mask": "0x00F0",
                "value": "0x0050"
            }
        ]
    },
    "A14_LED_HAZARD_OFF": {
        "description": "Turn high voltage warning LED off",
        "steps": [
            {
                "description": "",
                "operation": "modify",
                "register": "A14LED",
                "mask": "0x0004",
                "value": "0x0000"
            }
        ]
    },
    "A14_LED_HAZARD_ON": {
        "description": "Turn high voltage warning LED on",
        "steps": [
            {
                "description": "",
                "operation": "modify",
                "register": "A14LED",
                "mask": "0x0004",
                "value": "0x0004"
            }
        ]
    },
    "A14_INIT": {
        "description": "Initialize A14 MSP430",
        "steps": [
            {
                "description": "Bit 7 is PWM for LED bright",
                "operation": "write",
                "register": "P14P2SEL",
                "value": "0x80"
            },
            {
                "description": "2 MSb are outputs",
                "operation": "write",
                "register": "P14P2DIR",
                "value": "0xc0"
            },
            {
                "description": "TC function bit set hi",
                "operation": "write",
                "register": "P14P2",
                "value": "0x40"
            },
            {
                "description": "TC function output bits",
                "operation": "write",
                "register": "P14P3DIR",
                "value": "0xfc"
            },
            {
                "description": "Set all hi",
                "operation": "write",
                "register": "P14P3",
                "value": "0xfc"
            },
            {
                "description": "LED port set to output",
                "operation": "write",
                "register": "P14P4DIR",
                "value": "0xff"
            },
            {
                "description": "Full drive strength",
                "operation": "write",
                "register": "P14P4DS",
                "value": "0xff"
            },
            {
                "description": "LED 2nd port",
                "operation": "write",
                "register": "P14P5DIR",
                "value": "0xff"
            },
            {
                "description": "Full drive",
                "operation": "write",
                "register": "P14P5DS",
                "value": "0xff"
            },
            {
                "description": "Relay port",
                "operation": "write",
                "register": "P14P6DIR",
                "value": "0xff"
            },
            {
                "description": "Full drive",
                "operation": "write",
                "register": "P14P6DS",
                "value": "0xff"
            },
            {
                "description": "Relay port",
                "operation": "write",
                "register": "P14P7DIR",
                "value": "0xff"
            },
            {
                "description": "rly strobe and k17,k18",
                "operation": "write",
                "register": "P14P8DIR",
                "value": "0xc3"
            },
            {
                "description": "strobes hi, relays off",
                "operation": "write",
                "register": "P14P8",
                "value": "0xc0"
            },
            {
                "description": "Terminal rings for DCV, standby light on",
                "operation": "write",
                "register": "A14LED",
                "value": "0x0052"
            },
            {
                "description": "Set all relays to dorm, part 1",
                "operation": "write",
                "register": "A14RLY1",
                "value": "0x100"
            },
            {
                "description": "Set all relays to dorm, part 2",
                "operation": "write",
                "register": "A14RLY2",
                "value": "0x000"
            },
            {
                "description": "select 16 MHz clock with prescaler of 2 for an 8 MHz clock",
                "operation": "write",
                "register": "P14PWM1CTL",
                "value": "0x250"
            },
            {
                "description": "",
                "operation": "write",
                "register": "P14PWM1EX0",
                "value": "0x0"
            },
            {
                "description": "",
                "operation": "write",
                "register": "P14PWM10CCTL",
                "value": "0x0"
            },
            {
                "description": "",
                "operation": "write",
                "register": "P14PWM11CCTL",
                "value": "0xe0"
            },
            {
                "description": "set frequency to 150 Hz (Hex value is 8 MHz / 150 Hz",
                "operation": "write",
                "register": "P14PWM10",
                "value": "0xd054"
            },
            {
                "description": "set duty to 50% (d054 / 2)",
                "operation": "write",
                "register": "P14PWM11",
                "value": "0x682a"
            }
        ]
    }
}
