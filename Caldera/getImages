# cp -pL 


# fluke-console-image-socfpga_cyclone5.tar  // symlink to fs

# /southwind/usr1/halfdome/angstrom/angstrom-socfpga/deploy/eglibc/images/socfpga_cyclone5 // path to images

# zImage // symlink to kernel

# modules-socfpga_cyclone5.tgz .. symlink to modules

source ./setup_environment

rm -rf ./modules/*
rm -rf ./target/*
rm -rf ./kernel/zImage
rm -rf ./loader/u-boot-with-spl.sfp
rm -rf ./loader/U-boot/*

rm -rf ./toolchain/*

echo Retrieving images from $PROJECT_IMAGES

cp -p $PROJECT_IMAGES/fluke-console-image-fluke-cda-caldera.tar ./target/rootfs.tar
cd ./target
tar -xf ./rootfs.tar
rm ./rootfs.tar
cd ..

cp -p $PROJECT_IMAGES/u-boot-with-spl.sfp-fluke-cda-caldera ./loader/u-boot-with-spl.sfp
cp -p $PROJECT_IMAGES/u-boot.img ./loader/U-boot/.
cp -p $PROJECT_IMAGES/modules-fluke-cda-caldera.tgz ./modules/.

cp -p $PROJECT_IMAGES/zImage ./kernel/.
cp -p $PROJECT_IMAGES/zImage-Caldera_soc_overlay.dtb ./DeviceTree/.
cp -p $PROJECT_IMAGES/zImage-Caldera_soc.dtb ./DeviceTree/.

cd ./modules
gunzip ./modules-fluke-cda-caldera.tgz
tar -xf ./modules-fluke-cda-caldera.tar
rm ./modules-fluke-cda-caldera.tar
cd ..

echo Retrieving toolchanin package from $TOOLCHAIN_REPO
cp -Rp $TOOLCHAIN_REPO/* ./toolchain/.
